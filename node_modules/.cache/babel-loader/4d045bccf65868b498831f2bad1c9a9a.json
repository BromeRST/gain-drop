{"ast":null,"code":"\"use strict\";\n\nvar __createBinding = this && this.__createBinding || (Object.create ? function (o, m, k, k2) {\n  if (k2 === undefined) k2 = k;\n  Object.defineProperty(o, k2, {\n    enumerable: true,\n    get: function () {\n      return m[k];\n    }\n  });\n} : function (o, m, k, k2) {\n  if (k2 === undefined) k2 = k;\n  o[k2] = m[k];\n});\n\nvar __setModuleDefault = this && this.__setModuleDefault || (Object.create ? function (o, v) {\n  Object.defineProperty(o, \"default\", {\n    enumerable: true,\n    value: v\n  });\n} : function (o, v) {\n  o[\"default\"] = v;\n});\n\nvar __importStar = this && this.__importStar || function (mod) {\n  if (mod && mod.__esModule) return mod;\n  var result = {};\n  if (mod != null) for (var k in mod) if (k !== \"default\" && Object.prototype.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);\n\n  __setModuleDefault(result, mod);\n\n  return result;\n};\n\nvar __awaiter = this && this.__awaiter || function (thisArg, _arguments, P, generator) {\n  function adopt(value) {\n    return value instanceof P ? value : new P(function (resolve) {\n      resolve(value);\n    });\n  }\n\n  return new (P || (P = Promise))(function (resolve, reject) {\n    function fulfilled(value) {\n      try {\n        step(generator.next(value));\n      } catch (e) {\n        reject(e);\n      }\n    }\n\n    function rejected(value) {\n      try {\n        step(generator[\"throw\"](value));\n      } catch (e) {\n        reject(e);\n      }\n    }\n\n    function step(result) {\n      result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected);\n    }\n\n    step((generator = generator.apply(thisArg, _arguments || [])).next());\n  });\n};\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.eosSignTx = exports.eosGetPublicKey = exports.eosGetAccountPaths = void 0;\n\nconst EosMessages = __importStar(require(\"@keepkey/device-protocol/lib/messages-eos_pb\"));\n\nconst Messages = __importStar(require(\"@keepkey/device-protocol/lib/messages_pb\"));\n\nconst core = __importStar(require(\"@shapeshiftoss/hdwallet-core\"));\n\nconst createHash = require(\"create-hash\");\n\nfunction eosSigFormatter(r, s, v) {\n  const base58 = require(\"bs58\");\n\n  var recoverId = 0x1f;\n  var signature = \"SIG_K1_\";\n  console.log(\"formatter logs\");\n  var keyBuffer = Buffer.alloc(65);\n  var rbuf = Buffer.from(r);\n  var sbuf = Buffer.from(s);\n  keyBuffer.writeUInt8(recoverId, 0);\n  rbuf.copy(keyBuffer, 1);\n  sbuf.copy(keyBuffer, 33);\n  console.log(keyBuffer);\n  const check = [keyBuffer];\n  var keyType = \"K1\"; // we only sign using K1 curve\n\n  check.push(Buffer.from(keyType));\n  console.log(check);\n  console.log(\"hash\");\n  console.log(createHash(\"ripemd160\").update(core.compatibleBufferConcat(check)).digest());\n  const chksum = createHash(\"ripemd160\").update(core.compatibleBufferConcat(check)).digest().slice(0, 4);\n  console.log(chksum);\n  signature = signature.concat(base58.encode(core.compatibleBufferConcat([keyBuffer, chksum])));\n  console.log(signature);\n  return signature;\n}\n\nfunction charToSymbol(c) {\n  if (c.charCodeAt(0) >= \"a\".charCodeAt(0) && c.charCodeAt(0) <= \"z\".charCodeAt(0)) {\n    return c.charCodeAt(0) - \"a\".charCodeAt(0) + 6;\n  }\n\n  if (c.charCodeAt(0) >= \"1\".charCodeAt(0) && c.charCodeAt(0) <= \"5\".charCodeAt(0)) {\n    return c.charCodeAt(0) - \"1\".charCodeAt(0) + 1;\n  }\n\n  return 0;\n}\n\nfunction nameToNumber(name) {\n  var Long = require(\"long\");\n\n  let value = new Long(0, 0, true);\n  let c = new Long(0, 0, true);\n\n  for (let i = 0; i < 13; i++) {\n    if (i < name.length && i < 13) {\n      c = Long.fromNumber(charToSymbol(name[i]), true);\n    }\n\n    if (i < 12) {\n      c = c.and(Long.fromString(\"1f\", true, 16));\n      c = c.shl(64 - 5 * (i + 1));\n    } else {\n      // last iteration\n      c = c.and(Long.fromString(\"0f\", true, 16));\n    }\n\n    value = value.or(c);\n  }\n\n  return value.toString();\n}\n\nfunction assetToNumber(asset) {\n  let assetSplit = asset.split(\" \"); // amount, symbol\n\n  let dot_pos = assetSplit[0].indexOf(\".\");\n  let fract_part = 0;\n  let int_part = 0;\n  let precision_digit = 0; // parse symbol\n\n  if (dot_pos != -1) {\n    precision_digit = assetSplit[0].length - dot_pos - 1;\n  } else {\n    precision_digit = 0;\n  }\n\n  let sym = symbolFromString(precision_digit, assetSplit[1]); //parse amount\n\n  if (dot_pos != -1) {\n    int_part = parseInt(assetSplit[0].slice(0, dot_pos));\n    fract_part = parseInt(assetSplit[0].slice(dot_pos + 1));\n\n    if (int_part < 0) {\n      fract_part *= -1;\n    }\n  } else {\n    int_part = parseInt(assetSplit[0]);\n  }\n\n  let amount = int_part;\n  amount *= Math.pow(10, sym & 0xff);\n  amount += fract_part;\n  return [amount, sym];\n}\n\nfunction symbolFromString(p, name) {\n  let result = 0;\n\n  for (var i = 0; i < name.length; i++) {\n    result |= name.charCodeAt(i) << 8 * (i + 1);\n  }\n\n  result |= p;\n  return result;\n}\n\nfunction eosGetAccountPaths(msg) {\n  return [{\n    addressNList: [0x80000000 + 44, 0x80000000 + core.slip44ByCoin(\"Eos\"), 0x80000000 + msg.accountIdx, 0, 0]\n  }];\n}\n\nexports.eosGetAccountPaths = eosGetAccountPaths;\n\nfunction eosGetPublicKey(transport, msg) {\n  return __awaiter(this, void 0, void 0, function* () {\n    const getPubkey = new EosMessages.EosGetPublicKey();\n    getPubkey.setAddressNList(msg.addressNList);\n    getPubkey.setShowDisplay(msg.showDisplay !== false);\n    getPubkey.setKind(msg.kind);\n    const response = yield transport.call(Messages.MessageType.MESSAGETYPE_EOSGETPUBLICKEY, getPubkey, {\n      msgTimeout: core.LONG_TIMEOUT\n    });\n    const eosPubkey = response.proto;\n    return core.mustBeDefined(eosPubkey.getWifPublicKey());\n  });\n}\n\nexports.eosGetPublicKey = eosGetPublicKey;\n\nfunction eosSignTx(transport, msg) {\n  return __awaiter(this, void 0, void 0, function* () {\n    return transport.lockDuring(() => __awaiter(this, void 0, void 0, function* () {\n      let resp; // check some params\n\n      if (msg.tx.actions.length > 1) {\n        throw new Error(`Too many actions in Eos transaction: Keepkey only supports one!`);\n      }\n\n      const signTx = new EosMessages.EosSignTx();\n      signTx.setAddressNList(msg.addressNList);\n      signTx.setChainId(core.fromHexString(msg.chain_id));\n      const txHeader = new EosMessages.EosTxHeader();\n      txHeader.setExpiration((Date.parse(msg.tx.expiration) - Date.parse(\"01 Jan 1970 00:00:00Z\") - new Date().getTimezoneOffset() * 60 * 1000) / 1000);\n      txHeader.setRefBlockNum(msg.tx.ref_block_num);\n      txHeader.setRefBlockPrefix(msg.tx.ref_block_prefix);\n      txHeader.setMaxNetUsageWords(msg.tx.max_net_usage_words);\n      txHeader.setMaxCpuUsageMs(msg.tx.max_cpu_usage_ms);\n      txHeader.setDelaySec(msg.tx.delay_sec);\n      signTx.setHeader(txHeader);\n      signTx.setNumActions(msg.tx.actions.length);\n      console.log(\"tx header\");\n      console.log(txHeader);\n      resp = yield transport.call(Messages.MessageType.MESSAGETYPE_EOSSIGNTX, signTx, {\n        msgTimeout: core.LONG_TIMEOUT,\n        omitLock: true\n      });\n\n      if (resp.message_enum !== Messages.MessageType.MESSAGETYPE_EOSTXACTIONREQUEST) {\n        throw new Error(`eos: unexpected response ${resp.message_type}`);\n      } // parse the common block of the action\n\n\n      let actCommon = new EosMessages.EosActionCommon();\n      actCommon.setAccount(nameToNumber(msg.tx.actions[0].account).toString());\n      actCommon.setName(nameToNumber(msg.tx.actions[0].name).toString()); // interate through authorizations and add them\n\n      for (let n = 0; n < msg.tx.actions[0].authorization.length; n++) {\n        let actPerm = new EosMessages.EosPermissionLevel();\n        actPerm.setActor(nameToNumber(msg.tx.actions[0].authorization[n].actor).toString());\n        actPerm.setPermission(nameToNumber(msg.tx.actions[0].authorization[n].permission).toString());\n        actCommon.addAuthorization(actPerm);\n      }\n\n      let actAck = new EosMessages.EosTxActionAck();\n      actAck.setCommon(actCommon); // parse the various action types here.\n\n      switch (msg.tx.actions[0].name) {\n        case \"transfer\":\n          {\n            // build the transfer action\n            let actType = new EosMessages.EosActionTransfer();\n            actType.setSender(nameToNumber(msg.tx.actions[0].data.from).toString());\n            actType.setReceiver(nameToNumber(msg.tx.actions[0].data.to).toString());\n            let actAsset = new EosMessages.EosAsset();\n            let assetParse = assetToNumber(msg.tx.actions[0].data.quantity);\n            actAsset.setAmount(assetParse[0].toString());\n            actAsset.setSymbol(assetParse[1].toString());\n            actType.setQuantity(actAsset);\n            actType.setMemo(msg.tx.actions[0].data.memo);\n            actAck.setTransfer(actType);\n            break;\n          }\n\n        default:\n          {}\n      }\n\n      console.log(\"action data\");\n      console.log(actAck);\n      resp = yield transport.call(Messages.MessageType.MESSAGETYPE_EOSTXACTIONACK, actAck, {\n        msgTimeout: core.LONG_TIMEOUT,\n        omitLock: true\n      });\n\n      if (resp.message_enum !== Messages.MessageType.MESSAGETYPE_EOSSIGNEDTX) {\n        throw new Error(`eos: unexpected response ${resp.message_type}`);\n      }\n\n      const signedTx = resp.proto; // format signature for use in the eos system\n      //    const EosFormatSig = eosSigFormatter(signedTx.getSignatureR() as Uint8Array, signedTx.getSignatureS() as Uint8Array, signedTx.getSignatureV())\n\n      const signatureR = signedTx.getSignatureR_asU8();\n      const signatureS = signedTx.getSignatureS_asU8();\n      const signatureV = signedTx.getSignatureV();\n      if (signatureV === undefined) throw new Error(\"missing signatureV\");\n      var sig = {\n        signatureV,\n        signatureR,\n        signatureS,\n        hash: signedTx.getHash(),\n        eosFormSig: eosSigFormatter(signatureR, signatureS, signatureV)\n      };\n      return sig;\n    }));\n  });\n}\n\nexports.eosSignTx = eosSignTx;","map":{"version":3,"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;;AACA;;AACA;;AAIA,MAAMA,UAAU,GAAGC,OAAO,CAAC,aAAD,CAA1B;;AAEA,SAASC,eAAT,CAAyBC,CAAzB,EAAwCC,CAAxC,EAAuDC,CAAvD,EAAgE;AAC9D,QAAMC,MAAM,GAAGL,OAAO,CAAC,MAAD,CAAtB;;AAEA,MAAIM,SAAS,GAAG,IAAhB;AAEA,MAAIC,SAAS,GAAW,SAAxB;AAEAC,SAAO,CAACC,GAAR,CAAY,gBAAZ;AACA,MAAIC,SAAS,GAAGC,MAAM,CAACC,KAAP,CAAa,EAAb,CAAhB;AACA,MAAIC,IAAI,GAAGF,MAAM,CAACG,IAAP,CAAYZ,CAAZ,CAAX;AACA,MAAIa,IAAI,GAAGJ,MAAM,CAACG,IAAP,CAAYX,CAAZ,CAAX;AACAO,WAAS,CAACM,UAAV,CAAqBV,SAArB,EAAgC,CAAhC;AACAO,MAAI,CAACI,IAAL,CAAUP,SAAV,EAAqB,CAArB;AACAK,MAAI,CAACE,IAAL,CAAUP,SAAV,EAAqB,EAArB;AAEAF,SAAO,CAACC,GAAR,CAAYC,SAAZ;AACA,QAAMQ,KAAK,GAAG,CAACR,SAAD,CAAd;AACA,MAAIS,OAAO,GAAG,IAAd,CAjB8D,CAiB1C;;AACpBD,OAAK,CAACE,IAAN,CAAWT,MAAM,CAACG,IAAP,CAAYK,OAAZ,CAAX;AAEAX,SAAO,CAACC,GAAR,CAAYS,KAAZ;AAEAV,SAAO,CAACC,GAAR,CAAY,MAAZ;AACAD,SAAO,CAACC,GAAR,CAAYV,UAAU,CAAC,WAAD,CAAV,CAAwBsB,MAAxB,CAA+BC,IAAI,CAACC,sBAAL,CAA4BL,KAA5B,CAA/B,EAAmEM,MAAnE,EAAZ;AACA,QAAMC,MAAM,GAAG1B,UAAU,CAAC,WAAD,CAAV,CAAwBsB,MAAxB,CAA+BC,IAAI,CAACC,sBAAL,CAA4BL,KAA5B,CAA/B,EAAmEM,MAAnE,GAA4EE,KAA5E,CAAkF,CAAlF,EAAqF,CAArF,CAAf;AAEAlB,SAAO,CAACC,GAAR,CAAYgB,MAAZ;AACAlB,WAAS,GAAGA,SAAS,CAACoB,MAAV,CAAiBtB,MAAM,CAACuB,MAAP,CAAcN,IAAI,CAACC,sBAAL,CAA4B,CAACb,SAAD,EAAYe,MAAZ,CAA5B,CAAd,CAAjB,CAAZ;AAEAjB,SAAO,CAACC,GAAR,CAAYF,SAAZ;AAEA,SAAOA,SAAP;AACD;;AAED,SAASsB,YAAT,CAAsBC,CAAtB,EAA+B;AAC7B,MAAIA,CAAC,CAACC,UAAF,CAAa,CAAb,KAAmB,IAAIA,UAAJ,CAAe,CAAf,CAAnB,IAAwCD,CAAC,CAACC,UAAF,CAAa,CAAb,KAAmB,IAAIA,UAAJ,CAAe,CAAf,CAA/D,EAAkF;AAChF,WAAOD,CAAC,CAACC,UAAF,CAAa,CAAb,IAAkB,IAAIA,UAAJ,CAAe,CAAf,CAAlB,GAAsC,CAA7C;AACD;;AACD,MAAID,CAAC,CAACC,UAAF,CAAa,CAAb,KAAmB,IAAIA,UAAJ,CAAe,CAAf,CAAnB,IAAwCD,CAAC,CAACC,UAAF,CAAa,CAAb,KAAmB,IAAIA,UAAJ,CAAe,CAAf,CAA/D,EAAkF;AAChF,WAAOD,CAAC,CAACC,UAAF,CAAa,CAAb,IAAkB,IAAIA,UAAJ,CAAe,CAAf,CAAlB,GAAsC,CAA7C;AACD;;AACD,SAAO,CAAP;AACD;;AAED,SAASC,YAAT,CAAsBC,IAAtB,EAAkC;AAChC,MAAIC,IAAI,GAAGlC,OAAO,CAAC,MAAD,CAAlB;;AACA,MAAImC,KAAK,GAAG,IAAID,IAAJ,CAAS,CAAT,EAAY,CAAZ,EAAe,IAAf,CAAZ;AACA,MAAIJ,CAAC,GAAG,IAAII,IAAJ,CAAS,CAAT,EAAY,CAAZ,EAAe,IAAf,CAAR;;AAEA,OAAK,IAAIE,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAG,EAApB,EAAwBA,CAAC,EAAzB,EAA6B;AAC3B,QAAIA,CAAC,GAAGH,IAAI,CAACI,MAAT,IAAmBD,CAAC,GAAG,EAA3B,EAA+B;AAC7BN,OAAC,GAAGI,IAAI,CAACI,UAAL,CAAgBT,YAAY,CAACI,IAAI,CAACG,CAAD,CAAL,CAA5B,EAAuC,IAAvC,CAAJ;AACD;;AAED,QAAIA,CAAC,GAAG,EAAR,EAAY;AACVN,OAAC,GAAGA,CAAC,CAACS,GAAF,CAAML,IAAI,CAACM,UAAL,CAAgB,IAAhB,EAAsB,IAAtB,EAA4B,EAA5B,CAAN,CAAJ;AACAV,OAAC,GAAGA,CAAC,CAACW,GAAF,CAAM,KAAK,KAAKL,CAAC,GAAG,CAAT,CAAX,CAAJ;AACD,KAHD,MAGO;AACL;AACAN,OAAC,GAAGA,CAAC,CAACS,GAAF,CAAML,IAAI,CAACM,UAAL,CAAgB,IAAhB,EAAsB,IAAtB,EAA4B,EAA5B,CAAN,CAAJ;AACD;;AACDL,SAAK,GAAGA,KAAK,CAACO,EAAN,CAASZ,CAAT,CAAR;AACD;;AACD,SAAOK,KAAK,CAACQ,QAAN,EAAP;AACD;;AAED,SAASC,aAAT,CAAuBC,KAAvB,EAAoC;AAClC,MAAIC,UAAU,GAAGD,KAAK,CAACE,KAAN,CAAY,GAAZ,CAAjB,CADkC,CACC;;AACnC,MAAIC,OAAO,GAAGF,UAAU,CAAC,CAAD,CAAV,CAAcG,OAAd,CAAsB,GAAtB,CAAd;AACA,MAAIC,UAAU,GAAG,CAAjB;AACA,MAAIC,QAAQ,GAAG,CAAf;AACA,MAAIC,eAAe,GAAG,CAAtB,CALkC,CAOlC;;AACA,MAAIJ,OAAO,IAAI,CAAC,CAAhB,EAAmB;AACjBI,mBAAe,GAAGN,UAAU,CAAC,CAAD,CAAV,CAAcT,MAAd,GAAuBW,OAAvB,GAAiC,CAAnD;AACD,GAFD,MAEO;AACLI,mBAAe,GAAG,CAAlB;AACD;;AAED,MAAIC,GAAG,GAAGC,gBAAgB,CAACF,eAAD,EAAkBN,UAAU,CAAC,CAAD,CAA5B,CAA1B,CAdkC,CAelC;;AACA,MAAIE,OAAO,IAAI,CAAC,CAAhB,EAAmB;AACjBG,YAAQ,GAAGI,QAAQ,CAACT,UAAU,CAAC,CAAD,CAAV,CAAcpB,KAAd,CAAoB,CAApB,EAAuBsB,OAAvB,CAAD,CAAnB;AACAE,cAAU,GAAGK,QAAQ,CAACT,UAAU,CAAC,CAAD,CAAV,CAAcpB,KAAd,CAAoBsB,OAAO,GAAG,CAA9B,CAAD,CAArB;;AACA,QAAIG,QAAQ,GAAG,CAAf,EAAkB;AAChBD,gBAAU,IAAI,CAAC,CAAf;AACD;AACF,GAND,MAMO;AACLC,YAAQ,GAAGI,QAAQ,CAACT,UAAU,CAAC,CAAD,CAAX,CAAnB;AACD;;AACD,MAAIU,MAAM,GAAGL,QAAb;AACAK,QAAM,IAAIC,IAAI,CAACC,GAAL,CAAS,EAAT,EAAaL,GAAG,GAAG,IAAnB,CAAV;AACAG,QAAM,IAAIN,UAAV;AACA,SAAO,CAACM,MAAD,EAASH,GAAT,CAAP;AACD;;AAED,SAASC,gBAAT,CAA0BK,CAA1B,EAAqC1B,IAArC,EAAiD;AAC/C,MAAI2B,MAAM,GAAG,CAAb;;AACA,OAAK,IAAIxB,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGH,IAAI,CAACI,MAAzB,EAAiCD,CAAC,EAAlC,EAAsC;AACpCwB,UAAM,IAAI3B,IAAI,CAACF,UAAL,CAAgBK,CAAhB,KAAuB,KAAKA,CAAC,GAAG,CAAT,CAAjC;AACD;;AACDwB,QAAM,IAAID,CAAV;AACA,SAAOC,MAAP;AACD;;AAED,SAAgBC,kBAAhB,CAAmCC,GAAnC,EAA+D;AAC7D,SAAO,CACL;AACEC,gBAAY,EAAE,CAAC,aAAa,EAAd,EAAkB,aAAazC,IAAI,CAAC0C,YAAL,CAAkB,KAAlB,CAA/B,EAAyD,aAAaF,GAAG,CAACG,UAA1E,EAAsF,CAAtF,EAAyF,CAAzF;AADhB,GADK,CAAP;AAKD;;AANDC;;AAQA,SAAsBC,eAAtB,CAAsCC,SAAtC,EAA4DN,GAA5D,EAAqF;;AACnF,UAAMO,SAAS,GAAG,IAAIC,WAAW,CAACC,eAAhB,EAAlB;AACAF,aAAS,CAACG,eAAV,CAA0BV,GAAG,CAACC,YAA9B;AACAM,aAAS,CAACI,cAAV,CAAyBX,GAAG,CAACY,WAAJ,KAAoB,KAA7C;AACAL,aAAS,CAACM,OAAV,CAAkBb,GAAG,CAACc,IAAtB;AAEA,UAAMC,QAAQ,GAAG,MAAMT,SAAS,CAACU,IAAV,CAAeC,QAAQ,CAACC,WAAT,CAAqBC,2BAApC,EAAiEZ,SAAjE,EAA4E;AACjGa,gBAAU,EAAE5D,IAAI,CAAC6D;AADgF,KAA5E,CAAvB;AAIA,UAAMC,SAAS,GAAGP,QAAQ,CAACQ,KAA3B;AACA,WAAO/D,IAAI,CAACgE,aAAL,CAAmBF,SAAS,CAACG,eAAV,EAAnB,CAAP;AACD;AAAA;;AAZDrB;;AAcA,SAAsBsB,SAAtB,CAAgCpB,SAAhC,EAAsDN,GAAtD,EAA2E;;AACzE,WAAOM,SAAS,CAACqB,UAAV,CAAqB,MAAWC;AACrC,UAAIC,IAAJ,CADqC,CAGrC;;AACA,UAAI7B,GAAG,CAAC8B,EAAJ,CAAOC,OAAP,CAAexD,MAAf,GAAwB,CAA5B,EAA+B;AAC7B,cAAM,IAAIyD,KAAJ,CAAU,iEAAV,CAAN;AACD;;AAED,YAAMC,MAAM,GAAG,IAAIzB,WAAW,CAAC0B,SAAhB,EAAf;AACAD,YAAM,CAACvB,eAAP,CAAuBV,GAAG,CAACC,YAA3B;AACAgC,YAAM,CAACE,UAAP,CAAkB3E,IAAI,CAAC4E,aAAL,CAAmBpC,GAAG,CAACqC,QAAvB,CAAlB;AACA,YAAMC,QAAQ,GAAG,IAAI9B,WAAW,CAAC+B,WAAhB,EAAjB;AAEAD,cAAQ,CAACE,aAAT,CACE,CAACC,IAAI,CAACC,KAAL,CAAW1C,GAAG,CAAC8B,EAAJ,CAAOa,UAAlB,IACCF,IAAI,CAACC,KAAL,CAAW,uBAAX,CADD,GAEC,IAAID,IAAJ,GAAWG,iBAAX,KAAiC,EAAjC,GAAsC,IAFxC,IAGE,IAJJ;AAMAN,cAAQ,CAACO,cAAT,CAAwB7C,GAAG,CAAC8B,EAAJ,CAAOgB,aAA/B;AACAR,cAAQ,CAACS,iBAAT,CAA2B/C,GAAG,CAAC8B,EAAJ,CAAOkB,gBAAlC;AACAV,cAAQ,CAACW,mBAAT,CAA6BjD,GAAG,CAAC8B,EAAJ,CAAOoB,mBAApC;AACAZ,cAAQ,CAACa,gBAAT,CAA0BnD,GAAG,CAAC8B,EAAJ,CAAOsB,gBAAjC;AACAd,cAAQ,CAACe,WAAT,CAAqBrD,GAAG,CAAC8B,EAAJ,CAAOwB,SAA5B;AACArB,YAAM,CAACsB,SAAP,CAAiBjB,QAAjB;AACAL,YAAM,CAACuB,aAAP,CAAqBxD,GAAG,CAAC8B,EAAJ,CAAOC,OAAP,CAAexD,MAApC;AAEA7B,aAAO,CAACC,GAAR,CAAY,WAAZ;AACAD,aAAO,CAACC,GAAR,CAAY2F,QAAZ;AACAT,UAAI,GAAG,MAAMvB,SAAS,CAACU,IAAV,CAAeC,QAAQ,CAACC,WAAT,CAAqBuC,qBAApC,EAA2DxB,MAA3D,EAAmE;AAC9Eb,kBAAU,EAAE5D,IAAI,CAAC6D,YAD6D;AAE9EqC,gBAAQ,EAAE;AAFoE,OAAnE,CAAb;;AAKA,UAAI7B,IAAI,CAAC8B,YAAL,KAAsB1C,QAAQ,CAACC,WAAT,CAAqB0C,8BAA/C,EAA+E;AAC7E,cAAM,IAAI5B,KAAJ,CAAU,4BAA4BH,IAAI,CAACgC,YAAY,EAAvD,CAAN;AACD,OApCoC,CAqCrC;;;AACA,UAAIC,SAAS,GAAG,IAAItD,WAAW,CAACuD,eAAhB,EAAhB;AACAD,eAAS,CAACE,UAAV,CAAqB9F,YAAY,CAAC8B,GAAG,CAAC8B,EAAJ,CAAOC,OAAP,CAAe,CAAf,EAAkBkC,OAAnB,CAAZ,CAAwCpF,QAAxC,EAArB;AACAiF,eAAS,CAACI,OAAV,CAAkBhG,YAAY,CAAC8B,GAAG,CAAC8B,EAAJ,CAAOC,OAAP,CAAe,CAAf,EAAkB5D,IAAnB,CAAZ,CAAqCU,QAArC,EAAlB,EAxCqC,CAyCrC;;AACA,WAAK,IAAIsF,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGnE,GAAG,CAAC8B,EAAJ,CAAOC,OAAP,CAAe,CAAf,EAAkBqC,aAAlB,CAAgC7F,MAApD,EAA4D4F,CAAC,EAA7D,EAAiE;AAC/D,YAAIE,OAAO,GAAG,IAAI7D,WAAW,CAAC8D,kBAAhB,EAAd;AACAD,eAAO,CAACE,QAAR,CAAiBrG,YAAY,CAAC8B,GAAG,CAAC8B,EAAJ,CAAOC,OAAP,CAAe,CAAf,EAAkBqC,aAAlB,CAAgCD,CAAhC,EAAmCK,KAApC,CAAZ,CAAuD3F,QAAvD,EAAjB;AACAwF,eAAO,CAACI,aAAR,CAAsBvG,YAAY,CAAC8B,GAAG,CAAC8B,EAAJ,CAAOC,OAAP,CAAe,CAAf,EAAkBqC,aAAlB,CAAgCD,CAAhC,EAAmCO,UAApC,CAAZ,CAA4D7F,QAA5D,EAAtB;AACAiF,iBAAS,CAACa,gBAAV,CAA2BN,OAA3B;AACD;;AAED,UAAIO,MAAM,GAAG,IAAIpE,WAAW,CAACqE,cAAhB,EAAb;AACAD,YAAM,CAACE,SAAP,CAAiBhB,SAAjB,EAlDqC,CAmDrC;;AACA,cAAQ9D,GAAG,CAAC8B,EAAJ,CAAOC,OAAP,CAAe,CAAf,EAAkB5D,IAA1B;AACE,aAAK,UAAL;AAAiB;AACf;AACA,gBAAI4G,OAAO,GAAG,IAAIvE,WAAW,CAACwE,iBAAhB,EAAd;AACAD,mBAAO,CAACE,SAAR,CAAkB/G,YAAY,CAAC8B,GAAG,CAAC8B,EAAJ,CAAOC,OAAP,CAAe,CAAf,EAAkBmD,IAAlB,CAAuBlI,IAAxB,CAAZ,CAA0C6B,QAA1C,EAAlB;AACAkG,mBAAO,CAACI,WAAR,CAAoBjH,YAAY,CAAC8B,GAAG,CAAC8B,EAAJ,CAAOC,OAAP,CAAe,CAAf,EAAkBmD,IAAlB,CAAuBE,EAAxB,CAAZ,CAAwCvG,QAAxC,EAApB;AAEA,gBAAIwG,QAAQ,GAAG,IAAI7E,WAAW,CAAC8E,QAAhB,EAAf;AACA,gBAAIC,UAAU,GAAGzG,aAAa,CAACkB,GAAG,CAAC8B,EAAJ,CAAOC,OAAP,CAAe,CAAf,EAAkBmD,IAAlB,CAAuBM,QAAxB,CAA9B;AACAH,oBAAQ,CAACI,SAAT,CAAmBF,UAAU,CAAC,CAAD,CAAV,CAAc1G,QAAd,EAAnB;AACAwG,oBAAQ,CAACK,SAAT,CAAmBH,UAAU,CAAC,CAAD,CAAV,CAAc1G,QAAd,EAAnB;AAEAkG,mBAAO,CAACY,WAAR,CAAoBN,QAApB;AACAN,mBAAO,CAACa,OAAR,CAAgB5F,GAAG,CAAC8B,EAAJ,CAAOC,OAAP,CAAe,CAAf,EAAkBmD,IAAlB,CAAuBW,IAAvC;AACAjB,kBAAM,CAACkB,WAAP,CAAmBf,OAAnB;AACA;AACD;;AACD;AAAS,WACR;AAlBH;;AAqBArI,aAAO,CAACC,GAAR,CAAY,aAAZ;AACAD,aAAO,CAACC,GAAR,CAAYiI,MAAZ;AAEA/C,UAAI,GAAG,MAAMvB,SAAS,CAACU,IAAV,CAAeC,QAAQ,CAACC,WAAT,CAAqB6E,0BAApC,EAAgEnB,MAAhE,EAAwE;AACnFxD,kBAAU,EAAE5D,IAAI,CAAC6D,YADkE;AAEnFqC,gBAAQ,EAAE;AAFyE,OAAxE,CAAb;;AAIA,UAAI7B,IAAI,CAAC8B,YAAL,KAAsB1C,QAAQ,CAACC,WAAT,CAAqB8E,uBAA/C,EAAwE;AACtE,cAAM,IAAIhE,KAAJ,CAAU,4BAA4BH,IAAI,CAACgC,YAAY,EAAvD,CAAN;AACD;;AAED,YAAMoC,QAAQ,GAAGpE,IAAI,CAACN,KAAtB,CApFqC,CAsFrC;AAEA;;AAEA,YAAM2E,UAAU,GAAGD,QAAQ,CAACE,kBAAT,EAAnB;AACA,YAAMC,UAAU,GAAGH,QAAQ,CAACI,kBAAT,EAAnB;AACA,YAAMC,UAAU,GAAGL,QAAQ,CAACM,aAAT,EAAnB;AACA,UAAID,UAAU,KAAKE,SAAnB,EAA8B,MAAM,IAAIxE,KAAJ,CAAU,oBAAV,CAAN;AAC9B,UAAIyE,GAAG,GAAG;AACRH,kBADQ;AAERJ,kBAFQ;AAGRE,kBAHQ;AAIRM,YAAI,EAAET,QAAQ,CAACU,OAAT,EAJE;AAKRC,kBAAU,EAAEzK,eAAe,CAAC+J,UAAD,EAAaE,UAAb,EAAyBE,UAAzB;AALnB,OAAV;AAQA,aAAOG,GAAP;AACD,KAvGsC,CAAhC,CAAP;AAwGD;AAAA;;AAzGDrG","names":["createHash","require","eosSigFormatter","r","s","v","base58","recoverId","signature","console","log","keyBuffer","Buffer","alloc","rbuf","from","sbuf","writeUInt8","copy","check","keyType","push","update","core","compatibleBufferConcat","digest","chksum","slice","concat","encode","charToSymbol","c","charCodeAt","nameToNumber","name","Long","value","i","length","fromNumber","and","fromString","shl","or","toString","assetToNumber","asset","assetSplit","split","dot_pos","indexOf","fract_part","int_part","precision_digit","sym","symbolFromString","parseInt","amount","Math","pow","p","result","eosGetAccountPaths","msg","addressNList","slip44ByCoin","accountIdx","exports","eosGetPublicKey","transport","getPubkey","EosMessages","EosGetPublicKey","setAddressNList","setShowDisplay","showDisplay","setKind","kind","response","call","Messages","MessageType","MESSAGETYPE_EOSGETPUBLICKEY","msgTimeout","LONG_TIMEOUT","eosPubkey","proto","mustBeDefined","getWifPublicKey","eosSignTx","lockDuring","__awaiter","resp","tx","actions","Error","signTx","EosSignTx","setChainId","fromHexString","chain_id","txHeader","EosTxHeader","setExpiration","Date","parse","expiration","getTimezoneOffset","setRefBlockNum","ref_block_num","setRefBlockPrefix","ref_block_prefix","setMaxNetUsageWords","max_net_usage_words","setMaxCpuUsageMs","max_cpu_usage_ms","setDelaySec","delay_sec","setHeader","setNumActions","MESSAGETYPE_EOSSIGNTX","omitLock","message_enum","MESSAGETYPE_EOSTXACTIONREQUEST","message_type","actCommon","EosActionCommon","setAccount","account","setName","n","authorization","actPerm","EosPermissionLevel","setActor","actor","setPermission","permission","addAuthorization","actAck","EosTxActionAck","setCommon","actType","EosActionTransfer","setSender","data","setReceiver","to","actAsset","EosAsset","assetParse","quantity","setAmount","setSymbol","setQuantity","setMemo","memo","setTransfer","MESSAGETYPE_EOSTXACTIONACK","MESSAGETYPE_EOSSIGNEDTX","signedTx","signatureR","getSignatureR_asU8","signatureS","getSignatureS_asU8","signatureV","getSignatureV","undefined","sig","hash","getHash","eosFormSig"],"sourceRoot":"","sources":["../src/eos.ts"],"sourcesContent":[null]},"metadata":{},"sourceType":"script"}