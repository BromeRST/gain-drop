{"ast":null,"code":"'use strict';\n\nObject.defineProperty(exports, '__esModule', {\n  value: true\n});\n\nfunction _interopDefault(ex) {\n  return ex && typeof ex === 'object' && 'default' in ex ? ex['default'] : ex;\n}\n\nfunction _interopNamespace(e) {\n  if (e && e.__esModule) {\n    return e;\n  } else {\n    var n = {};\n\n    if (e) {\n      Object.keys(e).forEach(function (k) {\n        var d = Object.getOwnPropertyDescriptor(e, k);\n        Object.defineProperty(n, k, d.get ? d : {\n          enumerable: true,\n          get: function () {\n            return e[k];\n          }\n        });\n      });\n    }\n\n    n['default'] = e;\n    return n;\n  }\n}\n\nvar ReactDOM = _interopDefault(require('react-dom'));\n\nvar React = require('react');\n\nvar React__default = _interopDefault(React);\n\nvar Modal = _interopDefault(require('react-modal'));\n\nvar events = require('events');\n\nvar rxjs = require('rxjs');\n\nvar QRCode = _interopDefault(require('qrcode.react'));\n\nvar bcUr = require('@ngraveio/bc-ur');\n\nconst BaseQRCode = _ref => {\n  let {\n    size = 200,\n    data = '',\n    ecl = 'L'\n  } = _ref;\n  return React__default.createElement(QRCode, {\n    value: data,\n    size: size,\n    level: ecl\n  });\n};\n\n(function (ReadStatus) {\n  ReadStatus[\"canceled\"] = \"canceled\";\n  ReadStatus[\"success\"] = \"success\";\n})(exports.ReadStatus || (exports.ReadStatus = {}));\n\n(function (PlayStatus) {\n  PlayStatus[\"canceled\"] = \"canceled\";\n  PlayStatus[\"success\"] = \"success\";\n})(exports.PlayStatus || (exports.PlayStatus = {}));\n\n(function (SupportedResult) {\n  SupportedResult[\"UR_BYTES\"] = \"bytes\";\n  SupportedResult[\"UR_CRYPTO_HDKEY\"] = \"crypto-hdkey\";\n  SupportedResult[\"UR_ETH_SIGN_REQUEST\"] = \"eth-sign-request\";\n  SupportedResult[\"UR_ETH_SIGNATURE\"] = \"eth-signature\";\n})(exports.SupportedResult || (exports.SupportedResult = {}));\n\nconst styleBase = {\n  minWidth: '16rem',\n  height: '3rem',\n  background: '#784FFE',\n  borderColor: 'grey',\n  borderRadius: '8px',\n  borderWidth: 1,\n  color: 'white',\n  outline: 'none',\n  margin: 2\n};\n\nconst Button = props => {\n  const {\n    onClick,\n    children\n  } = props;\n  return React__default.createElement(\"button\", {\n    onClick: onClick,\n    style: styleBase\n  }, children);\n};\n\nconst ButtonGroup = props => {\n  return React__default.createElement(\"div\", {\n    style: {\n      width: '100%',\n      marginTop: '1rem',\n      display: 'flex',\n      flexDirection: 'row-reverse',\n      alignItems: 'center',\n      justifyContent: 'center'\n    }\n  }, props.children);\n};\n\nconst DEFAULT_SPEED = 100;\nconst DEFAULT_UR = /*#__PURE__*/new bcUr.UR( /*#__PURE__*/Buffer.from('NO DATA', 'utf-8'));\n\nconst useAnimatedQRCodePlayer = () => {\n  const [data, setData] = React.useState(DEFAULT_UR);\n  const [shouldShow, setShouldShow] = React.useState(false);\n  const [refreshSpeed, setRefreshSpeed] = React.useState(DEFAULT_SPEED);\n  const [hasNext, setHasNext] = React.useState(false);\n  const [title, setTitle] = React.useState(null);\n  const [description, setDescription] = React.useState(null);\n  const urEncoder = React.useMemo(() => new bcUr.UREncoder(data), [data]);\n  const [qr, setQR] = React.useState(urEncoder.nextPart());\n  const ee = React.useMemo(() => new events.EventEmitter(), []);\n\n  const reset = () => {\n    setData(DEFAULT_UR);\n    setShouldShow(false);\n    setRefreshSpeed(DEFAULT_SPEED);\n  };\n\n  React.useEffect(() => {\n    if (urEncoder.cbor.toString('hex') !== DEFAULT_UR.cbor.toString('hex')) {\n      setShouldShow(true);\n    }\n  }, [urEncoder]);\n  React.useEffect(() => {\n    const subscribe = rxjs.interval(refreshSpeed).subscribe(() => {\n      setQR(urEncoder.nextPart());\n    });\n    return () => {\n      subscribe.unsubscribe();\n    };\n  }, [refreshSpeed, urEncoder]);\n\n  const finish = () => {\n    ee.emit('finish', true);\n  };\n\n  const element = shouldShow ? React__default.createElement(\"div\", {\n    style: {\n      display: 'flex',\n      flexDirection: 'column',\n      alignItems: 'center'\n    }\n  }, title && React__default.createElement(\"p\", {\n    style: {\n      fontSize: '1.25rem',\n      fontWeight: 'bold'\n    }\n  }, title), React__default.createElement(BaseQRCode, {\n    size: 288,\n    data: qr\n  }), description && React__default.createElement(\"p\", {\n    style: {\n      fontSize: '1rem',\n      textAlign: 'center'\n    }\n  }, description), React__default.createElement(ButtonGroup, null, React__default.createElement(Button, {\n    onClick: finish\n  }, hasNext ? 'Scan Keystone' : 'Finish'))) : React__default.createElement(\"div\", null);\n  return [element, {\n    play: (data, options) => {\n      return new Promise(resolve => {\n        setData(data);\n\n        if (options) {\n          options.refreshSpeed && setRefreshSpeed(options.refreshSpeed);\n          options.hasNext && setHasNext(options.hasNext);\n          options.title && setTitle(options.title);\n          options.description && setDescription(options.description);\n        }\n\n        ee.once('finish', () => {\n          reset();\n          resolve(exports.PlayStatus.success);\n        });\n      });\n    }\n  }];\n};\n\nclass URTypeError extends Error {\n  constructor(msg) {\n    super(msg); // Set the prototype explicitly.\n\n    Object.setPrototypeOf(this, URTypeError.prototype);\n  }\n\n}\n\nconst LoadingSpinner = () => {\n  return React__default.createElement(\"svg\", {\n    xmlns: \"http://www.w3.org/2000/svg\",\n    style: {\n      margin: 'auto',\n      display: 'block',\n      shapeRendering: 'auto',\n      animationPlayState: 'running',\n      animationDelay: '0s'\n    },\n    width: \"200px\",\n    height: \"200px\",\n    viewBox: \"0 0 100 100\",\n    preserveAspectRatio: \"xMidYMid\"\n  }, React__default.createElement(\"circle\", {\n    cx: \"50\",\n    cy: \"50\",\n    fill: \"none\",\n    stroke: \"#9b9b9b\",\n    strokeWidth: \"7\",\n    r: \"35\",\n    strokeDasharray: \"164.93361431346415 56.97787143782138\",\n    style: {\n      animationPlayState: 'running',\n      animationDelay: '0s'\n    }\n  }, React__default.createElement(\"animateTransform\", {\n    attributeName: \"transform\",\n    type: \"rotate\",\n    repeatCount: \"indefinite\",\n    dur: \"1s\",\n    values: \"0 50 50;360 50 50\",\n    keyTimes: \"0;1\",\n    style: {\n      animationPlayState: 'running',\n      animationDelay: '0s'\n    }\n  })));\n};\n\nconst QrReader = /*#__PURE__*/React__default.lazy(() => new Promise(function (resolve) {\n  resolve(_interopNamespace(require('react-qr-reader')));\n}));\nlet URTypeErrorMessage = '';\n\nconst useAnimatedQRCodeReader = () => {\n  const [cameraReady, setCameraReady] = React.useState(false);\n  const [expectTypes, setExpectTypes] = React.useState([]);\n  const [urDecoder, setURDecoder] = React.useState(new bcUr.URDecoder());\n  const [error, setError] = React.useState('');\n  const ee = React.useMemo(() => new events.EventEmitter(), []);\n  const [title, setTitle] = React.useState(null);\n  const [progress, setProgress] = React.useState(0);\n  const [description, setDescription] = React.useState(null);\n\n  const reset = () => {\n    setURDecoder(new bcUr.URDecoder());\n    setError('');\n  };\n\n  const processQRCode = (qr, errorMessgeOnURType) => {\n    processUR(qr, errorMessgeOnURType);\n  };\n\n  const handleStop = () => {\n    ee.emit('read', {\n      status: 'canceled'\n    });\n  };\n\n  const handleRetry = () => {\n    reset();\n  };\n\n  const processUR = (ur, errorMessgeOnURType) => {\n    try {\n      if (!urDecoder.isComplete()) {\n        urDecoder.receivePart(ur);\n        setProgress(urDecoder.getProgress());\n      } else {\n        const result = urDecoder.resultUR();\n        let foundExpected = false;\n        expectTypes.forEach(et => {\n          if (et === result.type) {\n            foundExpected = true;\n            ee.emit('read', {\n              result,\n              status: 'success'\n            });\n            return;\n          }\n        });\n        if (!foundExpected) throw new URTypeError(`received ur type ${result.type}, but expected [${expectTypes.join(',')}]`);\n      }\n    } catch (e) {\n      if (e instanceof URTypeError) {\n        setError(errorMessgeOnURType);\n      } else {\n        setError(e.message);\n      }\n    }\n  };\n\n  const element = React__default.createElement(\"div\", {\n    style: {\n      display: 'flex',\n      flexDirection: 'column',\n      alignItems: 'center'\n    }\n  }, title && React__default.createElement(\"p\", {\n    style: {\n      fontSize: '1.25rem',\n      fontWeight: 'bold'\n    }\n  }, title), description && React__default.createElement(\"p\", {\n    style: {\n      fontSize: '1rem',\n      textAlign: 'center'\n    }\n  }, description), React__default.createElement(React.Suspense, {\n    fallback: React__default.createElement(\"div\", null)\n  }, React__default.createElement(\"div\", {\n    style: {\n      position: 'relative',\n      width: '100%'\n    }\n  }, !cameraReady ? React__default.createElement(\"div\", {\n    style: {\n      position: 'absolute',\n      top: '50%',\n      left: '50%',\n      transform: 'translate(-50%, -50%)'\n    }\n  }, React__default.createElement(LoadingSpinner, null)) : null, React__default.createElement(QrReader, {\n    onScan: data => {\n      if (data) {\n        setCameraReady(true);\n        processQRCode(data, URTypeErrorMessage);\n      }\n    },\n    delay: 100,\n    style: {\n      width: '100%'\n    },\n    onError: e => {\n      setError(e.message);\n    }\n  }))), React__default.createElement(\"p\", null, (progress * 100).toFixed(0), \" %\"), error && React__default.createElement(\"p\", {\n    style: {\n      color: 'red',\n      fontSize: '1rem'\n    }\n  }, error), React__default.createElement(ButtonGroup, null, React__default.createElement(Button, {\n    onClick: handleStop\n  }, \"Close\"), error && React__default.createElement(Button, {\n    onClick: handleRetry\n  }, \"Retry\")));\n  return [element, {\n    read: (expect, options) => {\n      return new Promise(resolve => {\n        setExpectTypes(expect);\n\n        if (options) {\n          options.title && setTitle(options.title);\n          options.description && setDescription(options.description);\n          URTypeErrorMessage = options.URTypeErrorMessage ? options.URTypeErrorMessage : '';\n        }\n\n        ee.once('read', result => {\n          reset();\n          resolve(result);\n        });\n      });\n    },\n    cameraReady\n  }];\n};\n\nconst InitialPage = props => {\n  return React__default.createElement(\"div\", {\n    style: {\n      paddingLeft: '1rem'\n    }\n  }, React__default.createElement(\"div\", {\n    style: {\n      display: 'flex',\n      alignItems: 'center',\n      padding: 0\n    }\n  }, React__default.createElement(\"img\", {\n    style: {\n      display: 'inline-block'\n    },\n    src: \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAoCAYAAACfKfiZAAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAKAAAAACc9ikyAAAD+ElEQVRYCb1WbWiNURw/Z9caY5SyrKzVhuUtZcYoJdZ8kMywGClG+WK+eJsPmogNKfZBxBbmAyPyEgvtA8UUX9inbVeb8AGTd8t2j9/vdp91ntPzPPd57h3/+t1z/uf/ev7nnP9zhUiMsmH2BOgF9ifmIjmrVpgrDWuScxfMeqUW2EqiB2sjgrlJTDsNZmHACqyP2xJzGcyq2iU4E7kTzFVw7fEw+Qbou9bn94K7FCIlgNFh6I7y0E8oAQ9/NlEBuAig71ifv4VspM1iiJnHHsGZyPohjmdzxzeu79acsyFJm8UQMnzbfONmUIvnsRTG4g3DWAM8B24DM4GkaR88WMGcxkYtQr2h+wl8niYPPJ0Aix+AU2Cu8UlmASRe0gHA1L1JYaLUBEPToc7v1hx7XdISTc/3tAiaXs+uE3K2ZdJaQE/MnLdDzvvhm3ij2wDTkc4vj3lLx/gmji7tqmL6voYNcRze17zwv4CemNuc/xt8NSoqsau5OfoD2TSAxDb+EXDTNdeX0igeHYSCaajzfGoWZWDidU90O84XWIZuYw4EvwDT0OK527GG8VUPfcuO4wPAsVvqt/MolIYDbsSmxLPUiS+gEpgBOH1Z+7HOC90MMBFXYnn0jM35S8hDrtZJCFgBluZEHB/bIWenc6XVV1Qo/MCxCoM2ucUi0lwubX4YfBng1TKvQ1426MWY1NSolAs94jJKVoYaOh2DbqGw3ddQqutqkGcooEG5rmHM+8DvMNZs7KVuUaiUWOUjOO0k9HIjSpzOq1RRv0xgus2jnTkONhxbKsZ4A7gFlMbWRChddMLtZ4v3O0YiojZvq8rkEbwCrOai278Dkw98BxYBLYD+anaB58sREzerosiAaMExjCbvl0KpooAV6HIx2IN1Bk8FTgF6cLDiCLCTk86z8mlKSCzBbr6S90NSooumiXYm8MjBgG+3KbZehXGygw6XmAQrEU0C77TETxII3ofA6zrrZR+PIAvoBrhTEnvAPIBJZAIdQLzS8r8BkxGTNqq5AxLHocQY8iYxOIKuwCu4Sxkr8B7g5bLoIiYMTjoExAtOvTqASYiORtmmJCohxRfyBv3GeqkVnDJWgLQQaAV45iw3k5oKsAMySb9UDcVaKuduUYWiX1xDObPJI/AHDBXhBsnvwiBZCXChAuA/nWdkQLxg0bJGOf8/tDtG9fxNKqNfisX4ZKamC/Gw/Zzs9e9GiL1Q5n0ICn6A5gQJ5KY7C4Ig33s90WibdXOsr3ud7wsoshcwiaAUPfegRm76syHgBylINaIX0c1hout8FecB/i/Uy23OedvZP/4Z5cDzSeAnYAZnK54P/BcahygHAD5dNh12tilAIPoLD0OnpwCV000AAAAASUVORK5CYII=\",\n    alt: \"\"\n  }), React__default.createElement(\"div\", {\n    style: {\n      fontSize: '1.25rem',\n      fontWeight: 'bold',\n      marginLeft: '1rem'\n    }\n  }, \"Sync Keystone\")), React__default.createElement(\"ul\", {\n    style: {\n      marginTop: '2rem',\n      listStyleType: 'none',\n      padding: 0,\n      fontSize: '1rem'\n    }\n  }, React__default.createElement(\"li\", {\n    style: {\n      marginBottom: '0.75rem'\n    }\n  }, \"1. Turn on your Keystone hardware device\"), React__default.createElement(\"li\", {\n    style: {\n      marginBottom: '0.75rem'\n    }\n  }, `2. Select your \"${props.walletMode}\" as your Watch-only wallet(Companion App)`), React__default.createElement(\"li\", {\n    style: {\n      marginBottom: '0.75rem'\n    }\n  }, ' ', \"3. Press the \\\"Scan Keystone\\\" button and scan the QR Code displayed on your Keystone hardware wallet\"), React__default.createElement(\"li\", {\n    style: {\n      marginBottom: '0.75rem'\n    }\n  }, \" 4. Select account and check your watch-only wallet\")), React__default.createElement(\"div\", {\n    style: {\n      marginBottom: '1rem'\n    }\n  }, React__default.createElement(\"a\", {\n    style: {\n      marginTop: '1.25rem',\n      color: '#784FFE',\n      textDecoration: 'none'\n    },\n    href: props.link,\n    target: \"_blank\"\n  }, \"Click here to view detailed tutorial\")), React__default.createElement(Button, {\n    onClick: props.onButtonClick\n  }, \"Sync Keystone\"));\n};\n\nconst customStyles = {\n  overlay: {\n    zIndex: 999\n  },\n  content: {\n    top: '50%',\n    left: '50%',\n    right: 'auto',\n    bottom: 'auto',\n    borderRadius: '10px',\n    width: '37rem',\n    marginRight: '-50%',\n    transform: 'translate(-50%, -50%)',\n    postion: 'relative'\n  }\n};\n\nconst useController = () => {\n  const ee = React.useMemo(() => new events.EventEmitter(), []);\n  const [visible, setVisible] = React.useState(false);\n  const [walletMode, setWalltMode] = React.useState('');\n  const [link, setLink] = React.useState('');\n  const [mode, setMode] = React.useState(null);\n  const [AnimatedQRCodePlayer, {\n    play\n  }] = useAnimatedQRCodePlayer();\n  const [AnimatedQRCodeReader, {\n    read,\n    cameraReady\n  }] = useAnimatedQRCodeReader();\n\n  const close = () => {\n    ee.emit('close');\n    reset();\n  };\n\n  const reset = () => {\n    setMode(null);\n    setLink('');\n    setWalltMode('');\n    setVisible(false);\n  };\n\n  const goToRead = () => {\n    setMode('read');\n  };\n\n  const renderPannel = pageMode => {\n    if (pageMode === 'initial') {\n      return React__default.createElement(InitialPage, {\n        walletMode: walletMode,\n        link: link,\n        onButtonClick: goToRead\n      });\n    } else if (pageMode === 'read') {\n      return AnimatedQRCodeReader;\n    } else if (pageMode === 'play') {\n      return AnimatedQRCodePlayer;\n    } else {\n      return null;\n    }\n  };\n\n  const element = React__default.createElement(Modal, {\n    isOpen: visible,\n    style: customStyles\n  }, React__default.createElement(\"div\", {\n    onClick: close\n  }, React__default.createElement(\"img\", {\n    style: {\n      position: 'absolute',\n      top: '1rem',\n      right: '1rem'\n    },\n    src: \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAAMCAYAAABWdVznAAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAADKADAAQAAAABAAAADAAAAAATDPpdAAAAmklEQVQoFZWRwQ3DIAwAa4brJPBP80hnaD/lD5N0iYxEfRVBxBGRwsvgO2PZklJaReTrvX/eTk7O+VVKuTtgDRYVPyOeHAysAFV40jCGEB69aHN/YSRZGK4JVuKu5/DrToDoqnI9tOh4vXJ2Qlc96kSY2lTfWs0m9DCT0r3MSkUrXR9r3eBCNbuDrY/td23z7Vg3wQhGIgcD+wPGY2fPvHuWagAAAABJRU5ErkJggg==\"\n  })), React__default.createElement(\"div\", {\n    style: {\n      width: '35rem',\n      padding: 18,\n      flex: 1,\n      flexDirection: 'column',\n      alignItems: 'center',\n      justifyContent: 'center',\n      color: '#002237'\n    }\n  }, renderPannel(mode)));\n  return [element, {\n    play: (data, options) => {\n      return new Promise(async resolve => {\n        ee.once('close', () => {\n          resolve(exports.PlayStatus.canceled);\n        });\n        setVisible(true);\n        setMode('play');\n        await play(data, options);\n        reset();\n        resolve(exports.PlayStatus.success);\n      });\n    },\n    read: async (expect, options) => {\n      if (options.renderInitial) {\n        setWalltMode(options.renderInitial.walletMode);\n        setLink(options.renderInitial.link);\n        setMode('initial');\n        setVisible(true);\n        const result = await read(expect, options);\n        reset();\n        return result;\n      } else {\n        setMode('read');\n        setVisible(true);\n        const result = await read(expect, options);\n        reset();\n        return result;\n      }\n    },\n    cameraReady\n  }];\n};\n\nvar Root = () => {\n  const [Controller, {\n    read,\n    play,\n    cameraReady\n  }] = useController();\n  setupSdk(read, play, cameraReady);\n  return Controller;\n};\n\nlet initialized = false;\nlet read;\nlet play;\nlet cameraReady;\n\nconst bootstrap = () => {\n  const htmlBody = document.getElementsByTagName('body').item(0);\n  const sdkDiv = document.createElement('div');\n  sdkDiv.id = 'kv_sdk_container';\n  htmlBody.appendChild(sdkDiv);\n  Modal.setAppElement('#kv_sdk_container');\n  ReactDOM.render(React__default.createElement(Root), sdkDiv);\n};\n\nconst setupSdk = (r, p, status) => {\n  initialized = true;\n  read = r;\n  play = p;\n  cameraReady = status;\n};\n\nconst sdk = {\n  bootstrap,\n  getSdk: () => {\n    if (initialized) {\n      return {\n        read,\n        play,\n        cameraReady\n      };\n    } else {\n      throw new Error('SDK is not initialized');\n    }\n  }\n};\nexports.default = sdk;","map":{"version":3,"mappings":"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","names":["BaseQRCode","size","data","ecl","React","QRCode","value","level","ReadStatus","PlayStatus","SupportedResult","styleBase","minWidth","height","background","borderColor","borderRadius","borderWidth","color","outline","margin","Button","props","onClick","children","style","ButtonGroup","width","marginTop","display","flexDirection","alignItems","justifyContent","DEFAULT_SPEED","DEFAULT_UR","UR","Buffer","from","useAnimatedQRCodePlayer","setData","useState","shouldShow","setShouldShow","refreshSpeed","setRefreshSpeed","hasNext","setHasNext","title","setTitle","description","setDescription","urEncoder","useMemo","UREncoder","qr","setQR","nextPart","ee","EventEmitter","reset","useEffect","cbor","toString","subscribe","interval","unsubscribe","finish","emit","element","fontSize","fontWeight","textAlign","play","options","Promise","resolve","once","success","URTypeError","Error","constructor","msg","Object","setPrototypeOf","prototype","LoadingSpinner","xmlns","shapeRendering","animationPlayState","animationDelay","viewBox","preserveAspectRatio","cx","cy","fill","stroke","strokeWidth","r","strokeDasharray","attributeName","type","repeatCount","dur","values","keyTimes","QrReader","lazy","URTypeErrorMessage","useAnimatedQRCodeReader","cameraReady","setCameraReady","expectTypes","setExpectTypes","urDecoder","setURDecoder","URDecoder","error","setError","progress","setProgress","processQRCode","errorMessgeOnURType","processUR","handleStop","status","handleRetry","ur","isComplete","receivePart","getProgress","result","resultUR","foundExpected","forEach","et","join","e","message","Suspense","fallback","position","top","left","transform","onScan","delay","onError","toFixed","read","expect","InitialPage","paddingLeft","padding","src","alt","marginLeft","listStyleType","marginBottom","walletMode","textDecoration","href","link","target","onButtonClick","customStyles","overlay","zIndex","content","right","bottom","marginRight","postion","useController","visible","setVisible","setWalltMode","setLink","mode","setMode","AnimatedQRCodePlayer","AnimatedQRCodeReader","close","goToRead","renderPannel","pageMode","Modal","isOpen","flex","canceled","renderInitial","Controller","setupSdk","initialized","bootstrap","htmlBody","document","getElementsByTagName","item","sdkDiv","createElement","id","appendChild","setAppElement","ReactDOM","render","Root","p","sdk","getSdk"],"sources":["../src/components/BaseQRCode.tsx","../src/types.ts","../src/components/Button.tsx","../src/components/ButtonGroup.tsx","../src/hooks/useAnimatedQRCodePlayer.tsx","../src/error.ts","../src/components/LoadingSpinner.tsx","../src/hooks/useAnimatedQRCodeReader.tsx","../src/components/InitialPage.tsx","../src/hooks/useController.tsx","../src/Root.tsx","../src/service.ts"],"sourcesContent":["import React from 'react';\nimport QRCode from 'qrcode.react';\n\nexport const BaseQRCode = ({\n    size = 200,\n    data = '',\n    ecl = 'L',\n}: {\n    data: string;\n    size?: number;\n    ecl?: 'L' | 'M' | 'Q' | 'H';\n}) => {\n    return <QRCode value={data} size={size} level={ecl} />;\n};\n","import { UR } from '@ngraveio/bc-ur';\n\ntype DecodedSuccess = {\n    result: UR;\n    status: ReadStatus.success;\n};\n\ntype DecodedCanceled = {\n    status: ReadStatus.canceled;\n};\n\nexport type DecodedResult = DecodedSuccess | DecodedCanceled;\n\nexport enum ReadStatus {\n    canceled = 'canceled',\n    success = 'success',\n}\n\nexport enum PlayStatus {\n    canceled = 'canceled',\n    success = 'success',\n}\n\nexport type Play = (\n    data: UR,\n    options?: {\n        refreshSpeed?: number;\n        hasNext?: boolean;\n        title?: string;\n        description?: string;\n    },\n) => Promise<PlayStatus>;\n\nexport type Read = (\n    expect: SupportedResult[],\n    options?: {\n        title?: string;\n        description?: string;\n        renderInitial?: {\n            walletMode: string;\n            link: string;\n        };\n        URTypeErrorMessage?: string;\n    },\n) => Promise<DecodedResult>;\n\nexport enum SupportedResult {\n    UR_BYTES = 'bytes',\n    UR_CRYPTO_HDKEY = 'crypto-hdkey',\n    UR_ETH_SIGN_REQUEST = 'eth-sign-request',\n    UR_ETH_SIGNATURE = 'eth-signature',\n}\n","import React, { FunctionComponent } from 'react';\n\ntype Props = {\n    onClick: () => any;\n};\n\nconst styleBase = {\n    minWidth: '16rem',\n    height: '3rem',\n    background: '#784FFE',\n    borderColor: 'grey',\n    borderRadius: '8px',\n    borderWidth: 1,\n    color: 'white',\n    outline: 'none',\n    margin: 2,\n};\n\nexport const Button: FunctionComponent<Props> = (props) => {\n    const { onClick, children } = props;\n    return (\n        <button onClick={onClick} style={styleBase}>\n            {children}\n        </button>\n    );\n};\n","import React, { FunctionComponent } from 'react';\n\nexport const ButtonGroup: FunctionComponent = (props) => {\n    return (\n        <div\n            style={{\n                width: '100%',\n                marginTop: '1rem',\n                display: 'flex',\n                flexDirection: 'row-reverse',\n                alignItems: 'center',\n                justifyContent: 'center',\n            }}\n        >\n            {props.children}\n        </div>\n    );\n};\n","import React, { useEffect, useMemo, useState } from 'react';\nimport { interval } from 'rxjs';\nimport { BaseQRCode } from '../components/BaseQRCode';\nimport { Play, PlayStatus } from '../types';\nimport { EventEmitter } from 'events';\nimport { Button } from '../components/Button';\nimport { ButtonGroup } from '../components/ButtonGroup';\nimport { UR, UREncoder } from '@ngraveio/bc-ur';\n\nconst DEFAULT_SPEED = 100;\n\nconst DEFAULT_UR = new UR(Buffer.from('NO DATA', 'utf-8'));\n\nexport const useAnimatedQRCodePlayer = (): [JSX.Element, { play: Play }] => {\n    const [data, setData] = useState<UR>(DEFAULT_UR);\n    const [shouldShow, setShouldShow] = useState(false);\n\n    const [refreshSpeed, setRefreshSpeed] = useState(DEFAULT_SPEED);\n    const [hasNext, setHasNext] = useState(false);\n    const [title, setTitle] = useState<string | null>(null);\n    const [description, setDescription] = useState<string | null>(null);\n\n    const urEncoder = useMemo(() => new UREncoder(data), [data]);\n\n    const [qr, setQR] = useState<string>(urEncoder.nextPart());\n\n    const ee = useMemo(() => new EventEmitter(), []);\n    const reset = () => {\n        setData(DEFAULT_UR);\n        setShouldShow(false);\n        setRefreshSpeed(DEFAULT_SPEED);\n    };\n\n    useEffect(() => {\n        if (urEncoder.cbor.toString('hex') !== DEFAULT_UR.cbor.toString('hex')) {\n            setShouldShow(true);\n        }\n    }, [urEncoder]);\n\n    useEffect(() => {\n        const subscribe = interval(refreshSpeed).subscribe(() => {\n            setQR(urEncoder.nextPart());\n        });\n        return () => {\n            subscribe.unsubscribe();\n        };\n    }, [refreshSpeed, urEncoder]);\n\n    const finish = () => {\n        ee.emit('finish', true);\n    };\n\n    const element = shouldShow ? (\n        <div\n            style={{\n                display: 'flex',\n                flexDirection: 'column',\n                alignItems: 'center',\n            }}\n        >\n            {title && <p style={{ fontSize: '1.25rem', fontWeight: 'bold' }}>{title}</p>}\n            <BaseQRCode size={288} data={qr} />\n            {description && <p style={{ fontSize: '1rem', textAlign: 'center' }}>{description}</p>}\n            <ButtonGroup>\n                <Button onClick={finish}>{hasNext ? 'Scan Keystone' : 'Finish'}</Button>\n            </ButtonGroup>\n        </div>\n    ) : (\n        <div></div>\n    );\n\n    return [\n        element,\n        {\n            play: (data, options) => {\n                return new Promise((resolve) => {\n                    setData(data);\n                    if (options) {\n                        options.refreshSpeed && setRefreshSpeed(options.refreshSpeed);\n                        options.hasNext && setHasNext(options.hasNext);\n                        options.title && setTitle(options.title);\n                        options.description && setDescription(options.description);\n                    }\n                    ee.once('finish', () => {\n                        reset();\n                        resolve(PlayStatus.success);\n                    });\n                });\n            },\n        },\n    ];\n};\n","export class URTypeError extends Error {\n    constructor(msg: string) {\n        super(msg);\n\n        // Set the prototype explicitly.\n        Object.setPrototypeOf(this, URTypeError.prototype);\n    }\n}\n","import React from 'react';\n\nexport const LoadingSpinner = () => {\n    return (\n        <svg\n            xmlns=\"http://www.w3.org/2000/svg\"\n            style={{\n                margin: 'auto',\n                display: 'block',\n                shapeRendering: 'auto',\n                animationPlayState: 'running',\n                animationDelay: '0s',\n            }}\n            width=\"200px\"\n            height=\"200px\"\n            viewBox=\"0 0 100 100\"\n            preserveAspectRatio=\"xMidYMid\"\n        >\n            <circle\n                cx=\"50\"\n                cy=\"50\"\n                fill=\"none\"\n                stroke=\"#9b9b9b\"\n                strokeWidth=\"7\"\n                r=\"35\"\n                strokeDasharray=\"164.93361431346415 56.97787143782138\"\n                style={{ animationPlayState: 'running', animationDelay: '0s' }}\n            >\n                <animateTransform\n                    attributeName=\"transform\"\n                    type=\"rotate\"\n                    repeatCount=\"indefinite\"\n                    dur=\"1s\"\n                    values=\"0 50 50;360 50 50\"\n                    keyTimes=\"0;1\"\n                    style={{ animationPlayState: 'running', animationDelay: '0s' }}\n                ></animateTransform>\n            </circle>\n        </svg>\n    );\n};\n","import React, { useMemo, useState, Suspense } from 'react';\nimport { EventEmitter } from 'events';\nimport { Button } from '../components/Button';\nimport { URTypeError } from '../error';\n\nimport { Read, SupportedResult } from '../types';\nimport { ButtonGroup } from '../components/ButtonGroup';\nimport { LoadingSpinner } from '../components/LoadingSpinner';\nimport { URDecoder } from '@ngraveio/bc-ur';\n\nconst QrReader = React.lazy(() => import('react-qr-reader'));\n\nexport interface URQRCodeData {\n    total: number;\n    index: number;\n    data: string;\n}\n\nlet URTypeErrorMessage: string = '';\n\nexport const useAnimatedQRCodeReader = (): [JSX.Element, { read: Read; cameraReady: boolean }] => {\n    const [cameraReady, setCameraReady] = useState<boolean>(false);\n    const [expectTypes, setExpectTypes] = useState<SupportedResult[]>([]);\n    const [urDecoder, setURDecoder] = useState(new URDecoder());\n    const [error, setError] = useState('');\n    const ee = useMemo(() => new EventEmitter(), []);\n    const [title, setTitle] = useState<string | null>(null);\n    const [progress, setProgress] = useState(0);\n    const [description, setDescription] = useState<string | null>(null);\n    const reset = () => {\n        setURDecoder(new URDecoder());\n        setError('');\n    };\n\n    const processQRCode = (qr: string, errorMessgeOnURType: string) => {\n        processUR(qr, errorMessgeOnURType);\n    };\n\n    const handleStop = () => {\n        ee.emit('read', {\n            status: 'canceled',\n        });\n    };\n\n    const handleRetry = () => {\n        reset();\n    };\n\n    const processUR = (ur: string, errorMessgeOnURType: string) => {\n        try {\n            if (!urDecoder.isComplete()) {\n                urDecoder.receivePart(ur);\n                setProgress(urDecoder.getProgress());\n            } else {\n                const result = urDecoder.resultUR();\n                let foundExpected = false;\n                expectTypes.forEach((et) => {\n                    if (et === result.type) {\n                        foundExpected = true;\n                        ee.emit('read', {\n                            result,\n                            status: 'success',\n                        });\n                        return;\n                    }\n                });\n                if (!foundExpected)\n                    throw new URTypeError(`received ur type ${result.type}, but expected [${expectTypes.join(',')}]`);\n            }\n        } catch (e) {\n            if (e instanceof URTypeError) {\n                setError(errorMessgeOnURType);\n            } else {\n                setError(e.message);\n            }\n        }\n    };\n\n    const element = (\n        <div\n            style={{\n                display: 'flex',\n                flexDirection: 'column',\n                alignItems: 'center',\n            }}\n        >\n            {title && <p style={{ fontSize: '1.25rem', fontWeight: 'bold' }}>{title}</p>}\n            {description && <p style={{ fontSize: '1rem', textAlign: 'center' }}>{description}</p>}\n            <Suspense fallback={<div />}>\n                <div style={{ position: 'relative', width: '100%' }}>\n                    {!cameraReady ? (\n                        <div\n                            style={{\n                                position: 'absolute',\n                                top: '50%',\n                                left: '50%',\n                                transform: 'translate(-50%, -50%)',\n                            }}\n                        >\n                            <LoadingSpinner />\n                        </div>\n                    ) : null}\n                    <QrReader\n                        onScan={(data: any) => {\n                            if (data) {\n                                setCameraReady(true);\n                                processQRCode(data, URTypeErrorMessage);\n                            }\n                        }}\n                        delay={100}\n                        style={{ width: '100%' }}\n                        onError={(e) => {\n                            setError(e.message);\n                        }}\n                    />\n                </div>\n            </Suspense>\n            <p>{(progress * 100).toFixed(0)} %</p>\n            {error && <p style={{ color: 'red', fontSize: '1rem' }}>{error}</p>}\n            <ButtonGroup>\n                <Button onClick={handleStop}>Close</Button>\n                {error && <Button onClick={handleRetry}>Retry</Button>}\n            </ButtonGroup>\n        </div>\n    );\n\n    return [\n        element,\n        {\n            read: (expect, options) => {\n                return new Promise((resolve) => {\n                    setExpectTypes(expect);\n                    if (options) {\n                        options.title && setTitle(options.title);\n                        options.description && setDescription(options.description);\n                        URTypeErrorMessage = options.URTypeErrorMessage ? options.URTypeErrorMessage : '';\n                    }\n                    ee.once('read', (result) => {\n                        reset();\n                        resolve(result);\n                    });\n                });\n            },\n            cameraReady,\n        },\n    ];\n};\n","import React from 'react';\nimport { Button } from './Button';\n\nexport const InitialPage = (props: { walletMode: string; link: string; onButtonClick: () => void }) => {\n    return (\n        <div style={{ paddingLeft: '1rem' }}>\n            <div style={{ display: 'flex', alignItems: 'center', padding: 0 }}>\n                <img\n                    style={{ display: 'inline-block' }}\n                    src=\"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAoCAYAAACfKfiZAAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAKAAAAACc9ikyAAAD+ElEQVRYCb1WbWiNURw/Z9caY5SyrKzVhuUtZcYoJdZ8kMywGClG+WK+eJsPmogNKfZBxBbmAyPyEgvtA8UUX9inbVeb8AGTd8t2j9/vdp91ntPzPPd57h3/+t1z/uf/ev7nnP9zhUiMsmH2BOgF9ifmIjmrVpgrDWuScxfMeqUW2EqiB2sjgrlJTDsNZmHACqyP2xJzGcyq2iU4E7kTzFVw7fEw+Qbou9bn94K7FCIlgNFh6I7y0E8oAQ9/NlEBuAig71ifv4VspM1iiJnHHsGZyPohjmdzxzeu79acsyFJm8UQMnzbfONmUIvnsRTG4g3DWAM8B24DM4GkaR88WMGcxkYtQr2h+wl8niYPPJ0Aix+AU2Cu8UlmASRe0gHA1L1JYaLUBEPToc7v1hx7XdISTc/3tAiaXs+uE3K2ZdJaQE/MnLdDzvvhm3ij2wDTkc4vj3lLx/gmji7tqmL6voYNcRze17zwv4CemNuc/xt8NSoqsau5OfoD2TSAxDb+EXDTNdeX0igeHYSCaajzfGoWZWDidU90O84XWIZuYw4EvwDT0OK527GG8VUPfcuO4wPAsVvqt/MolIYDbsSmxLPUiS+gEpgBOH1Z+7HOC90MMBFXYnn0jM35S8hDrtZJCFgBluZEHB/bIWenc6XVV1Qo/MCxCoM2ucUi0lwubX4YfBng1TKvQ1426MWY1NSolAs94jJKVoYaOh2DbqGw3ddQqutqkGcooEG5rmHM+8DvMNZs7KVuUaiUWOUjOO0k9HIjSpzOq1RRv0xgus2jnTkONhxbKsZ4A7gFlMbWRChddMLtZ4v3O0YiojZvq8rkEbwCrOai278Dkw98BxYBLYD+anaB58sREzerosiAaMExjCbvl0KpooAV6HIx2IN1Bk8FTgF6cLDiCLCTk86z8mlKSCzBbr6S90NSooumiXYm8MjBgG+3KbZehXGygw6XmAQrEU0C77TETxII3ofA6zrrZR+PIAvoBrhTEnvAPIBJZAIdQLzS8r8BkxGTNqq5AxLHocQY8iYxOIKuwCu4Sxkr8B7g5bLoIiYMTjoExAtOvTqASYiORtmmJCohxRfyBv3GeqkVnDJWgLQQaAV45iw3k5oKsAMySb9UDcVaKuduUYWiX1xDObPJI/AHDBXhBsnvwiBZCXChAuA/nWdkQLxg0bJGOf8/tDtG9fxNKqNfisX4ZKamC/Gw/Zzs9e9GiL1Q5n0ICn6A5gQJ5KY7C4Ig33s90WibdXOsr3ud7wsoshcwiaAUPfegRm76syHgBylINaIX0c1hout8FecB/i/Uy23OedvZP/4Z5cDzSeAnYAZnK54P/BcahygHAD5dNh12tilAIPoLD0OnpwCV000AAAAASUVORK5CYII=\"\n                    alt=\"\"\n                />\n                <div style={{ fontSize: '1.25rem', fontWeight: 'bold', marginLeft: '1rem' }}>Sync Keystone</div>\n            </div>\n            <ul style={{ marginTop: '2rem', listStyleType: 'none', padding: 0, fontSize: '1rem' }}>\n                <li style={{ marginBottom: '0.75rem' }}>1. Turn on your Keystone hardware device</li>\n                <li\n                    style={{ marginBottom: '0.75rem' }}\n                >{`2. Select your \"${props.walletMode}\" as your Watch-only wallet(Companion App)`}</li>\n                <li style={{ marginBottom: '0.75rem' }}>\n                    {' '}\n                    3. Press the \"Scan Keystone\" button and scan the QR Code displayed on your Keystone hardware wallet\n                </li>\n                <li style={{ marginBottom: '0.75rem' }}> 4. Select account and check your watch-only wallet</li>\n            </ul>\n            <div style={{ marginBottom: '1rem' }}>\n                <a\n                    style={{ marginTop: '1.25rem', color: '#784FFE', textDecoration: 'none' }}\n                    href={props.link}\n                    target=\"_blank\"\n                >\n                    Click here to view detailed tutorial\n                </a>\n            </div>\n            <Button onClick={props.onButtonClick}>Sync Keystone</Button>\n        </div>\n    );\n};\n","import React, { useMemo, useState } from 'react';\nimport Modal from 'react-modal';\nimport { EventEmitter } from 'events';\nimport { useAnimatedQRCodePlayer } from './useAnimatedQRCodePlayer';\nimport { useAnimatedQRCodeReader } from './useAnimatedQRCodeReader';\nimport { Play, PlayStatus, Read } from '../types';\nimport { InitialPage } from '../components/InitialPage';\n\nconst customStyles = {\n    overlay: {\n        zIndex: 999,\n    },\n    content: {\n        top: '50%',\n        left: '50%',\n        right: 'auto',\n        bottom: 'auto',\n        borderRadius: '10px',\n        width: '37rem',\n        marginRight: '-50%',\n        transform: 'translate(-50%, -50%)',\n        postion: 'relative',\n    },\n};\n\nexport const useController = (): [\n    JSX.Element,\n    {\n        play: Play;\n        read: Read;\n        cameraReady: boolean;\n    },\n] => {\n    const ee = useMemo(() => new EventEmitter(), []);\n    const [visible, setVisible] = useState(false);\n    const [walletMode, setWalltMode] = useState('');\n    const [link, setLink] = useState('');\n    const [mode, setMode] = useState<'read' | 'play' | 'initial' | null>(null);\n    const [AnimatedQRCodePlayer, { play }] = useAnimatedQRCodePlayer();\n    const [AnimatedQRCodeReader, { read, cameraReady }] = useAnimatedQRCodeReader();\n    const close = () => {\n        ee.emit('close');\n        reset();\n    };\n\n    const reset = () => {\n        setMode(null);\n        setLink('');\n        setWalltMode('');\n        setVisible(false);\n    };\n\n    const goToRead = () => {\n        setMode('read');\n    };\n\n    const renderPannel = (pageMode: string) => {\n        if (pageMode === 'initial') {\n            return <InitialPage walletMode={walletMode} link={link} onButtonClick={goToRead} />;\n        } else if (pageMode === 'read') {\n            return AnimatedQRCodeReader;\n        } else if (pageMode === 'play') {\n            return AnimatedQRCodePlayer;\n        } else {\n            return null;\n        }\n    };\n\n    const element = (\n        <Modal isOpen={visible} style={customStyles}>\n            <div onClick={close}>\n                <img\n                    style={{ position: 'absolute', top: '1rem', right: '1rem' }}\n                    src=\"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAAMCAYAAABWdVznAAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAADKADAAQAAAABAAAADAAAAAATDPpdAAAAmklEQVQoFZWRwQ3DIAwAa4brJPBP80hnaD/lD5N0iYxEfRVBxBGRwsvgO2PZklJaReTrvX/eTk7O+VVKuTtgDRYVPyOeHAysAFV40jCGEB69aHN/YSRZGK4JVuKu5/DrToDoqnI9tOh4vXJ2Qlc96kSY2lTfWs0m9DCT0r3MSkUrXR9r3eBCNbuDrY/td23z7Vg3wQhGIgcD+wPGY2fPvHuWagAAAABJRU5ErkJggg==\"\n                />\n            </div>\n            <div\n                style={{\n                    width: '35rem',\n                    padding: 18,\n                    flex: 1,\n                    flexDirection: 'column',\n                    alignItems: 'center',\n                    justifyContent: 'center',\n                    color: '#002237',\n                }}\n            >\n                {renderPannel(mode)}\n            </div>\n        </Modal>\n    );\n    return [\n        element,\n        {\n            play: (data, options) => {\n                return new Promise<PlayStatus>(async (resolve) => {\n                    ee.once('close', () => {\n                        resolve(PlayStatus.canceled);\n                    });\n                    setVisible(true);\n                    setMode('play');\n                    await play(data, options);\n                    reset();\n                    resolve(PlayStatus.success);\n                });\n            },\n            read: async (expect, options) => {\n                if (options.renderInitial) {\n                    setWalltMode(options.renderInitial.walletMode);\n                    setLink(options.renderInitial.link);\n                    setMode('initial');\n                    setVisible(true);\n                    const result = await read(expect, options);\n                    reset();\n                    return result;\n                } else {\n                    setMode('read');\n                    setVisible(true);\n                    const result = await read(expect, options);\n                    reset();\n                    return result;\n                }\n            },\n            cameraReady,\n        },\n    ];\n};\n","import { setupSdk } from './service';\nimport { useController } from './hooks/useController';\n\nexport default () => {\n    const [Controller, { read, play, cameraReady }] = useController();\n    setupSdk(read, play, cameraReady);\n    return Controller;\n};\n","import ReactDOM from 'react-dom';\nimport Root from './Root';\nimport React from 'react';\nimport { Play, Read } from './types';\nimport Modal from 'react-modal';\n\nlet initialized = false;\nlet read: Read;\nlet play: Play;\nlet cameraReady: boolean;\n\nconst bootstrap = (): void => {\n    const htmlBody = document.getElementsByTagName('body').item(0) as HTMLBodyElement;\n    const sdkDiv = document.createElement('div');\n    sdkDiv.id = 'kv_sdk_container';\n    htmlBody.appendChild(sdkDiv);\n    Modal.setAppElement('#kv_sdk_container');\n    ReactDOM.render(React.createElement(Root), sdkDiv);\n};\n\nexport const setupSdk = (r: Read, p: Play, status: boolean) => {\n    initialized = true;\n    read = r;\n    play = p;\n    cameraReady = status;\n};\n\nconst sdk = {\n    bootstrap,\n    getSdk: () => {\n        if (initialized) {\n            return {\n                read,\n                play,\n                cameraReady,\n            };\n        } else {\n            throw new Error('SDK is not initialized');\n        }\n    },\n};\n\nexport default sdk;\n"]},"metadata":{},"sourceType":"script"}