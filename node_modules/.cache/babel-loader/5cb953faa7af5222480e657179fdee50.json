{"ast":null,"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.CryptoKeypath = void 0;\n\nconst lib_1 = require(\"./lib\");\n\nconst PathComponent_1 = require(\"./PathComponent\");\n\nconst RegistryItem_1 = require(\"./RegistryItem\");\n\nconst RegistryType_1 = require(\"./RegistryType\");\n\nvar Keys;\n\n(function (Keys) {\n  Keys[Keys[\"components\"] = 1] = \"components\";\n  Keys[Keys[\"source_fingerprint\"] = 2] = \"source_fingerprint\";\n  Keys[Keys[\"depth\"] = 3] = \"depth\";\n})(Keys || (Keys = {}));\n\nclass CryptoKeypath extends RegistryItem_1.RegistryItem {\n  constructor() {\n    let components = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : [];\n    let sourceFingerprint = arguments.length > 1 ? arguments[1] : undefined;\n    let depth = arguments.length > 2 ? arguments[2] : undefined;\n    super();\n    this.components = components;\n    this.sourceFingerprint = sourceFingerprint;\n    this.depth = depth;\n\n    this.getRegistryType = () => {\n      return RegistryType_1.RegistryTypes.CRYPTO_KEYPATH;\n    };\n\n    this.getPath = () => {\n      if (this.components.length === 0) {\n        return undefined;\n      }\n\n      const components = this.components.map(component => {\n        return `${component.isWildcard() ? '*' : component.getIndex()}${component.isHardened() ? \"'\" : ''}`;\n      });\n      return components.join('/');\n    };\n\n    this.getComponents = () => this.components;\n\n    this.getSourceFingerprint = () => this.sourceFingerprint;\n\n    this.getDepth = () => this.depth;\n\n    this.toDataItem = () => {\n      const map = {};\n      const components = [];\n      this.components && this.components.forEach(component => {\n        if (component.isWildcard()) {\n          components.push([]);\n        } else {\n          components.push(component.getIndex());\n        }\n\n        components.push(component.isHardened() ? true : false);\n      });\n      map[Keys.components] = components;\n\n      if (this.sourceFingerprint) {\n        map[Keys.source_fingerprint] = this.sourceFingerprint.readUInt32BE(0);\n      }\n\n      if (this.depth !== undefined) {\n        map[Keys.depth] = this.depth;\n      }\n\n      return new lib_1.DataItem(map);\n    };\n  }\n\n}\n\nexports.CryptoKeypath = CryptoKeypath;\n\nCryptoKeypath.fromDataItem = dataItem => {\n  const map = dataItem.getData();\n  const pathComponents = [];\n  const components = map[Keys.components];\n\n  if (components) {\n    for (let i = 0; i < components.length; i += 2) {\n      const isHardened = components[i + 1];\n      const path = components[i];\n\n      if (typeof path === 'number') {\n        pathComponents.push(new PathComponent_1.PathComponent({\n          index: path,\n          hardened: isHardened\n        }));\n      } else {\n        pathComponents.push(new PathComponent_1.PathComponent({\n          hardened: isHardened\n        }));\n      }\n    }\n  }\n\n  const _sourceFingerprint = map[Keys.source_fingerprint];\n  let sourceFingerprint;\n\n  if (_sourceFingerprint) {\n    sourceFingerprint = Buffer.alloc(4);\n    sourceFingerprint.writeUInt32BE(_sourceFingerprint, 0);\n  }\n\n  const depth = map[Keys.depth];\n  return new CryptoKeypath(pathComponents, sourceFingerprint, depth);\n};\n\nCryptoKeypath.fromCBOR = _cborPayload => {\n  const dataItem = lib_1.decodeToDataItem(_cborPayload);\n  return CryptoKeypath.fromDataItem(dataItem);\n};","map":{"version":3,"mappings":"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","names":["Keys","CryptoKeypath","RegistryItem_1","constructor","components","sourceFingerprint","depth","RegistryType_1","CRYPTO_KEYPATH","length","undefined","map","component","isWildcard","getIndex","isHardened","join","forEach","push","source_fingerprint","readUInt32BE","lib_1","exports","dataItem","getData","pathComponents","i","path","PathComponent_1","index","hardened","_sourceFingerprint","Buffer","alloc","writeUInt32BE","_cborPayload","fromDataItem"],"sourceRoot":"","sources":["../src/CryptoKeypath.ts"],"sourcesContent":[null]},"metadata":{},"sourceType":"script"}